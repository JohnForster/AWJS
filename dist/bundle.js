!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(){function t(){this.position={x:0,y:0}}return t.prototype.setPosition=function(t,e){this.position.x=t,this.position.y=e},t.prototype.moveUp=function(){this.position.y-=1},t.prototype.moveDown=function(){this.position.y+=1},t.prototype.moveLeft=function(){this.position.x-=1},t.prototype.moveRight=function(){this.position.x+=1},t}(),o=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},i=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=function(){function t(){this.ticksPerSecond=.5,this.sprites=[],this.cursorTile={x:1,y:1},this.map=[[0,0,0,1,1,0],[0,0,0,1,1,0],[0,0,1,1,1,0],[0,1,1,1,1,0],[0,0,0,1,1,0],[1,1,0,1,1,1]],this.canvas=this.setupCanvas(),this.context=this.canvas.getContext("2d"),this.cursor=new r}return t.prototype.setupCanvas=function(){var t=document.getElementById("canvas");return t.height=600,t.width=800,t},t.prototype.run=function(){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.loadSprites()];case 1:return t.sent(),this.gameTick(),setInterval(this.gameTick.bind(this),1e3/this.ticksPerSecond),[2]}})})},t.prototype.loadSprites=function(){return o(this,void 0,void 0,function(){var e,n;return i(this,function(r){switch(r.label){case 0:return[4,t.addImageProcess("assets/spriteSheet.png")];case 1:return e=r.sent(),[4,t.addImageProcess("assets/UISprites.png")];case 2:return n=r.sent(),this.sprites.push(t.getImageData(e,217,1567,16,16)),this.sprites.push(t.getImageData(e,340,1567,16,16)),this.sprites.push(t.getImageData(n,44,6,28,31)),[2]}})})},t.prototype.gameTick=function(){return o(this,void 0,void 0,function(){return i(this,function(t){return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.printMap(this.map),this.printCursor(this.cursor.position,2),this.cursor.moveDown(),[2]})})},t.prototype.printMap=function(t){var e=this,n=document.createElement("canvas"),r=n.getContext("2d"),o={x:16,y:16};t.forEach(function(t,n){t.forEach(function(t,i){var a=i*o.x,s=n*o.y;r.putImageData(e.sprites[t],a,s)})});var i=this.getMapSize(t,o),a={x:Math.ceil((this.canvas.width-i.x)/2),y:20};this.context.drawImage(n,a.x,a.y)},t.prototype.getMapSize=function(t,e){return{x:t.length*e.x,y:t[0].length*e.y}},t.prototype.printCursor=function(t,e){var n=document.createElement("canvas");n.getContext("2d").putImageData(this.sprites[e],0,0);var r=this.getMapSize(this.map,{x:16,y:16}),o=Math.ceil((this.canvas.width-r.x)/2),i=20,a=16*t.x+o-3,s=16*t.y+i-3;this.context.drawImage(n,a,s)},t.addImageProcess=function(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){return e(r)},r.onerror=function(){return n()},r.src=t})},t.getImageData=function(t,e,n,r,o){var i=document.createElement("canvas"),a=i.getContext("2d");return i.width=t.width,i.height=t.height,a.drawImage(t,0,0),a.getImageData(e,n,r,o)},t}();(new(function(){function t(){}return t.prototype.run=function(){(new a).run()},t}())).run()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWVFbmdpbmUvY3Vyc29yLnRzIiwid2VicGFjazovLy8uL3NyYy9nYW1lRW5naW5lL2VuZ2luZV9vbGQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC9hcHAudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQ3Vyc29yIiwidGhpcyIsInBvc2l0aW9uIiwieCIsInkiLCJzZXRQb3NpdGlvbiIsIm1vdmVVcCIsIm1vdmVEb3duIiwibW92ZUxlZnQiLCJtb3ZlUmlnaHQiLCJFbmdpbmUiLCJ0aWNrc1BlclNlY29uZCIsInNwcml0ZXMiLCJjdXJzb3JUaWxlIiwibWFwIiwiY2FudmFzIiwic2V0dXBDYW52YXMiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsImN1cnNvciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJoZWlnaHQiLCJ3aWR0aCIsInJ1biIsImxvYWRTcHJpdGVzIiwiX2EiLCJzZW50IiwiZ2FtZVRpY2siLCJzZXRJbnRlcnZhbCIsImFkZEltYWdlUHJvY2VzcyIsInNwcml0ZVNoZWV0IiwiVUlTcHJpdGVzIiwicHVzaCIsImdldEltYWdlRGF0YSIsImNsZWFyUmVjdCIsInByaW50TWFwIiwicHJpbnRDdXJzb3IiLCJfdGhpcyIsInRlbXBDYW52YXMiLCJjcmVhdGVFbGVtZW50IiwidGVtcENvbnRleHQiLCJ0aWxlU2l6ZSIsImZvckVhY2giLCJyb3ciLCJyb3dOdW1iZXIiLCJpZCIsImNvbE51bWJlciIsInB1dEltYWdlRGF0YSIsIm1hcFNpemUiLCJnZXRNYXBTaXplIiwidG9wIiwiTWF0aCIsImNlaWwiLCJkcmF3SW1hZ2UiLCJsZW5ndGgiLCJzcmMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImltZyIsIkltYWdlIiwib25sb2FkIiwib25lcnJvciIsImltYWdlIiwidG9wTGVmdFgiLCJ0b3BMZWZ0WSIsIkFwcCIsImVuZ2luZV9vbGQiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxZQUFBLENBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixF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ZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW50ZXJmYWNlIElQb3NpdGlvbiB7XG4gIHg6IG51bWJlcixcbiAgeTogbnVtYmVyXG59XG5cbmV4cG9ydCBjbGFzcyBDdXJzb3Ige1xuICBwb3NpdGlvbjogSVBvc2l0aW9uO1xuXG4gIGNvbnN0cnVjdG9yICgpIHtcbiAgICAvLyBTdG9yZSBpbWFnZSBkYXRhIGluIGN1cnNvciBjbGFzcyBvciBvbmx5IHBvc2l0aW9uIGRhdGE/XG4gICAgdGhpcy5wb3NpdGlvbiA9IHt4OiAwLCB5OiAwfVxuICB9XG5cbiAgc2V0UG9zaXRpb24oeDpudW1iZXIsIHk6bnVtYmVyKXtcbiAgICB0aGlzLnBvc2l0aW9uLnggPSB4XG4gICAgdGhpcy5wb3NpdGlvbi55ID0geVxuICB9XG4gIFxuICBtb3ZlVXAoKXtcbiAgICB0aGlzLnBvc2l0aW9uLnkgLT0gMVxuICB9XG4gIG1vdmVEb3duKCl7XG4gICAgdGhpcy5wb3NpdGlvbi55ICs9IDFcbiAgfVxuICBtb3ZlTGVmdCgpe1xuICAgIHRoaXMucG9zaXRpb24ueCAtPSAxXG4gIH1cbiAgbW92ZVJpZ2h0KCl7XG4gICAgdGhpcy5wb3NpdGlvbi54ICs9IDFcbiAgfVxufSIsImltcG9ydCB7IEN1cnNvciB9IGZyb20gJy4vY3Vyc29yJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFbmdpbmUge1xuICBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xuICBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XG4gIHRpY2tzUGVyU2Vjb25kOiBudW1iZXIgPSAwLjU7IC8vIHNldCB0aWNrc1BlclNlY29uZCBpbiBjb25maWc/XG4gIHNwcml0ZXM6IEltYWdlRGF0YVtdID0gW107XG4gIGN1cnNvcjogQ3Vyc29yO1xuICBjdXJzb3JUaWxlID0geyB4OiAxLCB5OiAxIH1cblxuICAvLyBUZW1wb3JhcmlseSBoYXJkIGNvZGVkXG4gIG1hcDogbnVtYmVyW11bXSA9IFtcbiAgICBbMCwwLDAsMSwxLDBdLFxuICAgIFswLDAsMCwxLDEsMF0sXG4gICAgWzAsMCwxLDEsMSwwXSxcbiAgICBbMCwxLDEsMSwxLDBdLFxuICAgIFswLDAsMCwxLDEsMF0sXG4gICAgWzEsMSwwLDEsMSwxXSxcbiAgXVxuICBcbiAgY29uc3RydWN0b3IgKCkge1xuICAgIC8vIEluamVjdCBjdXJzb3IgZGVwZW5kZW5jeT9cbiAgICB0aGlzLmNhbnZhcyA9IHRoaXMuc2V0dXBDYW52YXMoKTtcbiAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXG4gICAgdGhpcy5jdXJzb3IgPSBuZXcgQ3Vyc29yXG4gIH1cblxuICBwcml2YXRlIHNldHVwQ2FudmFzKCk6IEhUTUxDYW52YXNFbGVtZW50IHtcbiAgICBjb25zdCBjYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKTtcbiAgICBjYW52YXMuaGVpZ2h0ID0gNjAwOyAvLyBzZXQgZGltZW5zaW9ucyBpbiBjb25maWc/XG4gICAgY2FudmFzLndpZHRoID0gODAwO1xuICAgIHJldHVybiBjYW52YXM7XG4gIH1cblxuICBhc3luYyBydW4gKCkge1xuICAgIGF3YWl0IHRoaXMubG9hZFNwcml0ZXMoKVxuICAgIHRoaXMuZ2FtZVRpY2soKVxuICAgIHNldEludGVydmFsKHRoaXMuZ2FtZVRpY2suYmluZCh0aGlzKSwgMTAwMC90aGlzLnRpY2tzUGVyU2Vjb25kKVxuICB9XG5cbiAgYXN5bmMgbG9hZFNwcml0ZXMgKCkge1xuICAgIC8vIFdyaXRlIGdlbmVyaWMgbWV0aG9kIGZvciB0aGlzP1xuICAgIGNvbnN0IHNwcml0ZVNoZWV0ID0gPEhUTUxJbWFnZUVsZW1lbnQ+IGF3YWl0IEVuZ2luZS5hZGRJbWFnZVByb2Nlc3MoJ2Fzc2V0cy9zcHJpdGVTaGVldC5wbmcnKVxuICAgIGNvbnN0IFVJU3ByaXRlcyA9IDxIVE1MSW1hZ2VFbGVtZW50PiBhd2FpdCBFbmdpbmUuYWRkSW1hZ2VQcm9jZXNzKCdhc3NldHMvVUlTcHJpdGVzLnBuZycpXG4gICAgdGhpcy5zcHJpdGVzLnB1c2goRW5naW5lLmdldEltYWdlRGF0YShzcHJpdGVTaGVldCwgMjE3LCAxNTY3LCAxNiwgMTYpKSAvLyBncmFzc1xuICAgIHRoaXMuc3ByaXRlcy5wdXNoKEVuZ2luZS5nZXRJbWFnZURhdGEoc3ByaXRlU2hlZXQsIDM0MCwgMTU2NywgMTYsIDE2KSkgLy8gc2VhXG4gICAgdGhpcy5zcHJpdGVzLnB1c2goRW5naW5lLmdldEltYWdlRGF0YShVSVNwcml0ZXMsIDQ0LCA2LCAyOCwgMzEpKSAvLyBjdXJzb3JcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2FtZVRpY2sgKCkge1xuICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodClcbiAgICAvLyBjb25zdCBtYXAgPSB0aGlzLmdhbWUuY3VycmVudE1hcFN0YXRlXG4gICAgLy8gY29uc3QgdW5pdHMgPSB0aGlzLmdhbWUuY3VycmVudFVuaXRTdGF0ZSAvLyBNYXAgY2xhc3MgaG9sZHMgY3VycmVudCBtYXAgZGF0YT9cbiAgICAvLyB0aGlzLnJlbmRlcmVyLmRyYXdNYXAobWFwKVxuICAgIC8vIHRoaXMucmVuZGVyZXIuZHJhd1VuaXRzKHVuaXRzKVxuICAgIC8vIFRPRE8gbW92ZSBpbnRvIHJlbmRlcmVyIGNsYXNzLlxuICAgIHRoaXMucHJpbnRNYXAodGhpcy5tYXApXG4gICAgdGhpcy5wcmludEN1cnNvcih0aGlzLmN1cnNvci5wb3NpdGlvbiwgMilcbiAgICB0aGlzLmN1cnNvci5tb3ZlRG93bigpXG4gIH1cblxuICBwcml2YXRlIHByaW50TWFwIChtYXA6IG51bWJlcltdW10pIHtcbiAgICBjb25zdCB0ZW1wQ2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIGNvbnN0IHRlbXBDb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQgPSB0ZW1wQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgY29uc3QgdGlsZVNpemUgPSB7IHg6MTYsIHk6MTZ9XG4gICAgbWFwLmZvckVhY2goKHJvdywgcm93TnVtYmVyKSA9PiB7XG4gICAgICByb3cuZm9yRWFjaCgoaWQsIGNvbE51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB4ID0gKGNvbE51bWJlciAqIHRpbGVTaXplLngpXG4gICAgICAgIGNvbnN0IHkgPSAocm93TnVtYmVyICogdGlsZVNpemUueSlcbiAgICAgICAgdGVtcENvbnRleHQucHV0SW1hZ2VEYXRhKHRoaXMuc3ByaXRlc1tpZF0sIHgsIHkpXG4gICAgICB9KVxuICAgIH0pXG4gICAgY29uc3QgbWFwU2l6ZSA9IHRoaXMuZ2V0TWFwU2l6ZShtYXAsIHRpbGVTaXplKVxuICAgIGNvbnN0IHRvcCA9IHsgeDogTWF0aC5jZWlsKCh0aGlzLmNhbnZhcy53aWR0aCAtIG1hcFNpemUueCkgLyAyKSwgeTogMjAgfTtcbiAgICB0aGlzLmNvbnRleHQuZHJhd0ltYWdlKHRlbXBDYW52YXMsIHRvcC54LCB0b3AueSlcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TWFwU2l6ZShtYXA6IG51bWJlcltdW10sIHRpbGVTaXplOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyOyB9KSB7XG4gICAgcmV0dXJuIHsgeDogKG1hcC5sZW5ndGggKiB0aWxlU2l6ZS54KSwgeTogKG1hcFswXS5sZW5ndGggKiB0aWxlU2l6ZS55KSB9O1xuICB9XG5cbiAgcHJpdmF0ZSBwcmludEN1cnNvcihjdXJzb3JUaWxlOmFueSwgaWQ6bnVtYmVyKSB7XG4gICAgY29uc3QgdGVtcENhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICBjb25zdCB0ZW1wQ29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEID0gdGVtcENhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHRlbXBDb250ZXh0LnB1dEltYWdlRGF0YSh0aGlzLnNwcml0ZXNbaWRdLCAwLCAwKTtcbiAgICBjb25zdCBtYXBTaXplID0gdGhpcy5nZXRNYXBTaXplKHRoaXMubWFwLCB7eDoxNiwgeToxNn0pXG4gICAgY29uc3QgdG9wID0geyB4OiBNYXRoLmNlaWwoKHRoaXMuY2FudmFzLndpZHRoIC0gbWFwU2l6ZS54KSAvIDIpLCB5OiAyMCB9O1xuICAgIGNvbnN0IHggPSBjdXJzb3JUaWxlLnggKiAxNiArIHRvcC54IC0gMyAvLyBDdXJzb3Igc3F1YXJlIGlzIDYgcGl4ZWxzIHdpZGVyL3RhbGxlciB0aGFuIGEgdGlsZSwgMyBvbiBlYWNoIHNpZGVcbiAgICBjb25zdCB5ID0gY3Vyc29yVGlsZS55ICogMTYgKyB0b3AueSAtIDNcbiAgICB0aGlzLmNvbnRleHQuZHJhd0ltYWdlKHRlbXBDYW52YXMsIHgsIHkpXG4gIH1cblxuICBzdGF0aWMgYWRkSW1hZ2VQcm9jZXNzKHNyYzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IGltZzpIVE1MSW1hZ2VFbGVtZW50ID0gbmV3IEltYWdlKCk7XG4gICAgICBpbWcub25sb2FkID0gKCkgPT4gcmVzb2x2ZShpbWcpO1xuICAgICAgaW1nLm9uZXJyb3IgPSAoKSA9PiByZWplY3QoKTtcbiAgICAgIGltZy5zcmMgPSBzcmM7XG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgZ2V0SW1hZ2VEYXRhKGltYWdlOiBIVE1MSW1hZ2VFbGVtZW50LCB0b3BMZWZ0WDpudW1iZXIsIHRvcExlZnRZOm51bWJlciwgd2lkdGg6bnVtYmVyLCBoZWlnaHQ6bnVtYmVyKTpJbWFnZURhdGEge1xuICAgIGNvbnN0IHRlbXBDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICBjb25zdCB0ZW1wQ29udGV4dCA9IHRlbXBDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICB0ZW1wQ2FudmFzLndpZHRoID0gaW1hZ2Uud2lkdGg7XG4gICAgdGVtcENhbnZhcy5oZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XG4gICAgdGVtcENvbnRleHQuZHJhd0ltYWdlKGltYWdlLCAwLCAwKVxuICAgIHJldHVybiB0ZW1wQ29udGV4dC5nZXRJbWFnZURhdGEodG9wTGVmdFgsIHRvcExlZnRZLCB3aWR0aCwgaGVpZ2h0KVxuICB9XG59IiwiaW1wb3J0IEVuZ2luZSBmcm9tICcuLi9nYW1lRW5naW5lL2VuZ2luZV9vbGQnXG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBjbGFzcyBBcHAge1xuICBydW4gKCkge1xuICAgIGNvbnN0IGVuZ2luZSA9IG5ldyBFbmdpbmUoKVxuICAgIGVuZ2luZS5ydW4oKVxuICB9XG59IiwiaW1wb3J0IGFwcCBmcm9tICcuL2FwcC9hcHAnXG5cbmFwcC5ydW4oKSJdLCJzb3VyY2VSb290IjoiIn0=